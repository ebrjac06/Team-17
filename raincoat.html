<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Raincoat – Drip & Co</title>

  <link rel="stylesheet" href="puffer product.css">
  <link rel="stylesheet" href="Index.css">
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="search.css">
</head>

<body>
  <main>
    <div id="header"></div>

    <div class="product-container">
      <div class="product-images">
        <img
          src="images/raincoat.png"
          class="main-img"
          alt="Lightweight Waterproof Raincoat">
      </div>

      <div class="product-info">
        <h1>Raincoat</h1>
        <p class="price">£40.00</p>
        <p class="desc">
          Lightweight waterproof coat for wet weather. Features breathable material, 
          adjustable hood, and sealed seams to keep you dry in any condition.
        </p>

        <label for="size">Size:</label>
        <select id="size">
          <option>Select Size</option>
          <option>Small</option>
          <option>Medium</option>
          <option>Large</option>
          <option>XL</option>
        </select>

        <button class="add-btn">Add to Basket</button>
      </div>
    </div>
  </main>

  <div id="footer"></div>

  <script>
    fetch("header.php")
      .then(res => res.text())
      .then(data => {
        document.getElementById("header").innerHTML = data;
        
        if (typeof initDarkMode === 'function') {
          initDarkMode();
        }
      });

    fetch("footer.html")
      .then(res => res.text())
      .then(data => document.getElementById("footer").innerHTML = data);

    const addBtn = document.querySelector('.add-btn');

    addBtn.addEventListener('click', () => {
      const sizeSelect = document.getElementById('size');
      const selectedSize = sizeSelect.value;

      if (selectedSize === "Select Size") {
        alert("Please select a size before adding to basket!");
        return;
      }

      const product = {
        name: document.querySelector('.product-info h1').innerText,
        price: parseFloat(
          document.querySelector('.product-info .price').innerText.replace('£', '')
        ),
        size: selectedSize,
        quantity: 1,
        img: document.querySelector('.product-images .main-img').src
      };

      const basket = JSON.parse(localStorage.getItem('basket')) || [];

      const existingProduct = basket.find(
        item => item.name === product.name && item.size === product.size
      );

      if (existingProduct) {
        existingProduct.quantity += 1;
      } else {
        basket.push(product);
      }

      localStorage.setItem('basket', JSON.stringify(basket));
      alert("Product added to basket!");
    });
  </script>

  <script src="search.js"></script>
  <script src="darkmode.js"></script>
</body>
</html>
